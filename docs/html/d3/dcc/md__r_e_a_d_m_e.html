<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VCF Validator: vcf-validator | &lt;a href=&quot;https://github.com/EBIvariation/vcf-validator/actions/workflows/build.yml/badge.svg?branch=master&quot; &gt;&lt;img src=&quot;https://github.com/EBIvariation/vcf-validator/actions/workflows/build.yml/badge.svg?branch=master&quot; alt=&quot;Build Status&quot;/&gt;&lt;/a&gt; &lt;a href=&quot;https://ci.appveyor.com/project/ebivariation-bot/vcf-validator/branch/master&quot; &gt;&lt;img src=&quot;https://ci.appveyor.com/api/projects/status/vt4ldlwhm91e3n49/branch/master?svg=true&quot; alt=&quot;Build status&quot;/&gt;&lt;/a&gt;</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VCF Validator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d3/dcc/md__r_e_a_d_m_e.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">vcf-validator | &lt;a href="https://github.com/EBIvariation/vcf-validator/actions/workflows/build.yml/badge.svg?branch=master" &gt;&lt;img src="https://github.com/EBIvariation/vcf-validator/actions/workflows/build.yml/badge.svg?branch=master" alt="Build Status"/&gt;&lt;/a&gt; &lt;a href="https://ci.appveyor.com/project/ebivariation-bot/vcf-validator/branch/master" &gt;&lt;img src="https://ci.appveyor.com/api/projects/status/vt4ldlwhm91e3n49/branch/master?svg=true" alt="Build status"/&gt;&lt;/a&gt;</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md22"></a>Validation suite for Variant Call Format (VCF) files. Please find below instructions on how to download and run, or read the wiki for more details about checks already implemented.</p>
<p>This suite includes all the checks from the vcftools suite as well as additional lexical, syntactic and semantic analysis of the VCF input. If any inconsistencies are found, they are classified in one of the following categories:</p>
<ul>
<li>Errors: Violations of the VCF specification</li>
<li>Warnings: A recommendation is not followed or potentially wrong information appears in the file</li>
</ul>
<p>These tools have been implemented using C++11.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
Installation</h1>
<h2><a class="anchor" id="autotoc_md24"></a>
From Binaries</h2>
<p>The vcf-validator is built with all the dependencies included. It can be downloaded directly from the <a href="https://github.com/EBIvariation/vcf-validator/releases">latest release</a> for the most stable experience using vcf-validator. Along with the release notes, you will find the executables <code>vcf_validator</code>, <code>vcf_assembly_checker</code> and <code>vcf_debugulator</code> for Linux, macOS and Windows. For Windows, please also download the libraries in the <a href="https://github.com/EBIvariation/vcf-validator/tree/master/lib/windows_specific/">lib/windows_specific/</a> folder.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
From conda</h2>
<p>Starting from <a href="https://github.com/EBIvariation/vcf-validator/releases/tag/v0.9.6">v0.9.6</a>, you can install vcf-validator via conda using</p>
<div class="fragment"><div class="line">conda install -c bioconda vcf-validator</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md26"></a>
Run</h1>
<h2><a class="anchor" id="autotoc_md27"></a>
Validator</h2>
<p>vcf-validator accepts both compressed and non-compressed input VCF files. Supported compression formats are .gz and .bz2. For other formats such as .zip, the <code>zcat</code> command and a pipe can be used (see below).</p>
<p>Reading uncompressed files:</p><ul>
<li>File path as argument: <code>vcf_validator -i /path/to/file.vcf</code></li>
<li>Standard input: <code>vcf_validator &lt; /path/to/file.vcf</code></li>
<li>Standard input from pipe: <code>cat /path/to/file.vcf | vcf_validator</code></li>
</ul>
<p>Reading compressed files:</p><ul>
<li>File path as argument: <code>vcf_validator -i /path/to/compressed_file.vcf.gz</code></li>
<li>Standard input: <code>vcf_validator &lt; /path/to/compressed_file.vcf.bz2</code></li>
<li>Standard input from pipe: <code>zcat /path/to/compressed_file.vcf.zip | vcf_validator</code></li>
</ul>
<p>The validation level can be configured using <code>-l</code> / <code>--level</code>. This parameter is optional and accepts 3 values:</p>
<ul>
<li>error: Display only syntax errors</li>
<li>warning: Display both syntax and semantic, both errors and warnings (default)</li>
<li>stop: Stop after the first syntax error is found</li>
</ul>
<p>Different types of validation reports can be written with the <code>-r</code> / <code>--report</code> option. Several ones may be specified in the same execution, using commas to separate each type (without spaces, e.g.: <code>-r summary,database,text</code>).</p>
<ul>
<li>summary: Write a human-readable summary report to a file. This includes one line for each type of error and the number of occurrences, along with the first line that shows that type of error (default)</li>
<li>text: Write a human-readable report to a file, with one description line for each VCF line that has an error.</li>
<li>database: Write structured report to a database file. The database engine used is SQLite3, so the results can be inspected manually, but they are intended to be consumed by the debugulator.</li>
</ul>
<p>Each report is written into its own file and it is named after the input file, followed by a timestamp. The default output directory is the same as the input file's if provided using <code>-i</code>, or the current directory if using the standard input; it can be changed with the <code>-o</code> / <code>--outdir</code> option.</p>
<p>A flag for validating evidence can be passed with <code>--require-evidence</code>. This will validate whether the VCF includes either Genotypes or Allele Frequencies. This flag will be <b>false</b> by default.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Debugulator</h2>
<p>There are some simple errors that can be automatically fixed. The most common error is the presence of duplicate variants. The needed parameters are the original VCF and the report generated by a previous run of the validator with the option <code>-r database</code>.</p>
<p>The fixed VCF will be written into the standard output, which you can redirect to a file, or use the <code>-o</code> / <code>--output</code> option and specify the desired file name.</p>
<p>The logs about what the debugulator is doing will be written into the error output. The logs may be redirected to a log file using <code>2&gt;debugulator_log.txt</code> or completely discarded with <code>2&gt;/dev/null</code>.</p>
<h2><a class="anchor" id="autotoc_md29"></a>
Assembly Checker</h2>
<p>vcf-assembly-checker assesses the correctness of a VCF file with respect to a FASTA file (that should contain the reference sequence). The assembly checker reads the CHR, POS and REF columns from the VCF, and for each line, looks into the FASTA file to see if the REF allele matches that region. A VCF file is considered valid if all the variants match the sequence in the FASTA file.</p>
<p>vcf-assembly-checker requires a FASTA-index file with extension <code>.fai</code> for efficient reading of the FASTA file.</p>
<p>If the VCF and FASTA files to compare don't use the same contig name nomenclature (GenBank, RefSeq, UCSC...) you may provide an assembly report file to map between them, using the <code>-a</code> option.</p>
<p>vcf-assembly-checker accepts both compressed and non-compressed input VCF files. Supported compression formats are .gz and .bz2. For other formats such as .zip, the <code>zcat</code> command and a pipe can be used (see below).</p>
<p>Reading uncompressed files:</p><ul>
<li>File path as argument: <code>vcf_assembly_checker -i /path/to/vcf-file -f /path/to/fasta-file -a /path/to/assembly-report</code></li>
<li>Standard input: <code>vcf_assembly_checker -f /path/to/fasta-file -a /path/to/assembly-report &lt; /path/to/vcf-file</code></li>
<li>Standard input from pipe: <code>cat /path/to/vcf-file | vcf_assembly_checker -f /path/to/fasta-file -a /path/to/assembly-report</code></li>
</ul>
<p>Reading compressed files:</p><ul>
<li>File path as argument: <code>vcf_assembly_checker -i /path/to/compressed-vcf-file -f /path/to/fasta-file -a /path/to/assembly-report</code></li>
<li>Standard input: <code>vcf_assembly_checker -f /path/to/fasta-file -a /path/to/assembly-report &lt; /path/to/compressed-vcf-file</code></li>
<li>Standard input from pipe: <code>zcat /path/to/compressed-vcf-file | vcf_assembly_checker -f /path/to/fasta-file -a /path/to/assembly-report</code></li>
</ul>
<p>Different types of validation reports can be written with the <code>-r</code> / <code>--report</code> option. Several ones may be specified in the same execution, using commas to separate each type (without spaces, e.g.: <code>-r summary,valid,text</code>).</p>
<ul>
<li><code>summary</code> - Logs the number of matches, total variants checked and percentage of correctness of VCF file on the terminal.</li>
<li><code>valid</code> - Write valid lines (including meta-info lines) from the input VCF file into an output file.</li>
<li><code>text</code> - Write a human readable into file, containing errors and warnings generated while checking a VCF file.</li>
</ul>
<p>Each report is written into its own file and it is named after the input file, followed by a timestamp. The default output directory is the same as the input file's if provided using <code>-i</code>, or the current directory if using the standard input; it can be changed with the <code>-o</code> / <code>--outdir</code> option.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
Examples</h2>
<p>Simple example: <code>vcf_validator -i /path/to/file.vcf</code></p>
<p>Full example: <code>vcf_validator -i /path/to/file.vcf -l stop -r database,stdout -o /path/to/output/folder/</code></p>
<p>Debugulator example:</p>
<div class="fragment"><div class="line">vcf_validator -i /path/to/file.vcf -r database -o /path/to/write/report/</div>
<div class="line">vcf_debugulator -i /path/to/file.vcf -e /path/to/write/report/vcf.errors.timestamp.db -o /path/to/fixed.vcf 2&gt;debugulator_log.txt</div>
</div><!-- fragment --><p>Assembly Checker example:</p>
<div class="fragment"><div class="line"># Pass input (-i) and FASTA file (-f) paths </div>
<div class="line">vcf_assembly_checker -i /path/to/file.vcf -f /path/to/fasta_file.fa</div>
<div class="line"> </div>
<div class="line"># Pass input (-i) paths but read VCF input from command line (&lt;)</div>
<div class="line"># Report output required (-r)</div>
<div class="line">vcf_assembly_checker -f /path/to/fasta.fa -r text &lt; /path/to/file.vcf</div>
<div class="line"> </div>
<div class="line"># Pass input (-i), FASTA (-f) and assembly report (-a) paths</div>
<div class="line"># Report output required (-r)</div>
<div class="line"># If submitting to EVA, check if contigs have Genbank accessions (--require-genbank)</div>
<div class="line">   # see https://www.ebi.ac.uk/eva/?Submit-Data  </div>
<div class="line">vcf_assembly_checker -i /path/to/file.vcf -f /path/to/fasta_file.fa -r valid -a /path/to/assembly_report --require-genbank</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md31"></a>
Build</h1>
<p>If you would like to use an unreleased version of vcf-validator, you can clone the repository and build it under 3 platforms: Linux, macOS and Windows. A statically linked executable will be generated, which means you won't need to install any dependencies in the machine that will run it; only install the dependencies in the machine that will build it.</p>
<p>If you plan to make changes, make sure to check the <a class="el" href="../../db/dec/md_docs_2developer-guide.html">docs/developer-guide.md</a>.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
Linux</h2>
<p>The build has been tested on the following compilers:</p><ul>
<li>Clang 10</li>
<li>GCC 9</li>
</ul>
<h3><a class="anchor" id="autotoc_md33"></a>
Dependencies</h3>
<p>Some dependencies have to be installed manually and others can be installed automatically. We recommend using the automatic install when possible.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Dependency   </th><th class="markdownTableHeadCenter">Version   </th><th class="markdownTableHeadCenter">Instalation method    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Cmake   </td><td class="markdownTableBodyCenter">&gt;=2.8   </td><td class="markdownTableBodyCenter">manual    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Sqlite3   </td><td class="markdownTableBodyCenter">&gt;=3   </td><td class="markdownTableBodyCenter">manual    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ODB compiler   </td><td class="markdownTableBodyCenter">2.4.0   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">ODB common runtime   </td><td class="markdownTableBodyCenter">2.4.0   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ODB SQLite runtime   </td><td class="markdownTableBodyCenter">2.4.0   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">bzip2   </td><td class="markdownTableBodyCenter">1.0.6   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">zlib   </td><td class="markdownTableBodyCenter">1.2.11   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Boost*   </td><td class="markdownTableBodyCenter">&gt;=1.65   </td><td class="markdownTableBodyCenter">manual or automatic   </td></tr>
</table>
<p>*: See below the exact subset of Boost packages required.</p>
<p>If you are using Ubuntu 16, you can prepare all dependencies and compile the Validation Suite with these commands: </p><div class="fragment"><div class="line">sudo apt-get install libsqlite3-0 libsqlite3-dev cmake wget build-essential</div>
<div class="line">./install_dependencies.sh linux</div>
<div class="line">mkdir build &amp;&amp; cd build &amp;&amp; cmake -G &quot;Unix Makefiles&quot; ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>The VCF Validation Suite binaries will be created in the <code>build/bin</code> subfolder. Optionally, read below for the explanation of the previous commands.</p>
<h4><a class="anchor" id="autotoc_md34"></a>
SQLite, CMake and automatic installation</h4>
<p>The automatic install <b>requires</b> CMake, SQLite3 and wget to be installed before running the script (as ODB and zlib require them to be installed). Also, the script will compile some dependencies so a compilation environment is needed. If you are using Ubuntu, you can install all that with the command <code>sudo apt-get install libsqlite3-0 libsqlite3-dev cmake wget build-essential</code>. After installing that, use the command <code>./install_dependencies.sh linux</code>.</p>
<p>A subfolder named <code>linux_dependencies</code> will be created, with all the required libraries copied into it.</p>
<h4><a class="anchor" id="autotoc_md35"></a>
Boost</h4>
<p><b>Note</b>: You can ignore this section if you are using the <code>install_dependencies.sh</code> script.</p>
<p>The dependencies are the Boost library core, and its submodules: Boost.filesystem, Boost.iostreams, Boost.program_options, Boost.regex, Boost.log and Boost.system. If you are using Ubuntu, you can install them with the command <code>sudo apt-get install libboost-dev libboost-filesystem-dev libboost-iostreams-dev libboost-program-options-dev libboost-regex-dev libboost-log-dev</code>.</p>
<h4><a class="anchor" id="autotoc_md36"></a>
ODB</h4>
<p><b>Note</b>: You can ignore this section if you are using the <code>install_dependencies.sh</code> script.</p>
<p>You will need to download the ODB compiler, the ODB common runtime library, and the SQLite database runtime library from <a href="http://codesynthesis.com/products/odb/download.xhtml">this page</a>.</p>
<p>ODB requires SQLite3 to be installed. If you are using Ubuntu, the required packages' names will be <code>libsqlite3-0</code> and <code>libsqlite3-dev</code>.</p>
<p>To install the ODB compiler, the easiest way is to download the <code>.deb</code> or <code>.rpm</code> packages and install them automatically with <code>dpkg</code> or <code>rpm</code> respectively. Both the ODB common runtime and SQLite database runtime libraries can be installed manually running <code>./configure &amp;&amp; make &amp;&amp; sudo make install</code>. This will install the libraries in <code>/usr/local/lib</code>.</p>
<p>If you don't have root permissions, please run <code>./configure --prefix=/path/to/odb/libraries/folder</code> to specify which folder to install ODB in, then <code>make &amp;&amp; make install</code>, without <code>sudo</code>. Also you will have to provide the path to ODB while configuring libodb-sqlite using <code>./configure --with-libodb=/path/to/odb/libraries</code>.</p>
<h3><a class="anchor" id="autotoc_md37"></a>
Compile</h3>
<p>In order to create the build scripts, please run <code>cmake</code> with your preferred generator. For instance, <code>mkdir build &amp;&amp; cd build &amp;&amp; cmake -G "Unix Makefiles" ..</code> will create Makefiles, and to build the binaries, you will need to run <code>make</code>.</p>
<p>If the ODB libraries were not found during the build, please run <code>sudo updatedb &amp;&amp; sudo ldconfig</code>. Also, if ODB has been installed in a non-default location, the option <code>-DEXT_LIB_PATH=/path/to/external/libraries/folder</code> must be also provided to the <code>cmake</code> command.</p>
<p>The VCF Validation Suite binaries will be created in the <code>build/bin</code> subfolder.</p>
<h2><a class="anchor" id="autotoc_md38"></a>
macOS</h2>
<p>On macOS the binaries obtained will only have system libraries dynamically linked. This means you will need to install dependencies to build vcf-validator but not to run it.</p>
<h3><a class="anchor" id="autotoc_md39"></a>
Dependencies</h3>
<p>Some dependencies have to be installed manually and others can be installed automatically. We recommend using the automatic install when possible.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Dependency   </th><th class="markdownTableHeadCenter">Version   </th><th class="markdownTableHeadCenter">Instalation method    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Cmake   </td><td class="markdownTableBodyCenter">&gt;=2.8   </td><td class="markdownTableBodyCenter">manual    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Sqlite3   </td><td class="markdownTableBodyCenter">&gt;=3   </td><td class="markdownTableBodyCenter">manual    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ODB compiler   </td><td class="markdownTableBodyCenter">2.4.0   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">ODB common runtime   </td><td class="markdownTableBodyCenter">2.4.0   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ODB SQLite runtime   </td><td class="markdownTableBodyCenter">2.4.0   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">bzip2   </td><td class="markdownTableBodyCenter">1.0.6   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">zlib   </td><td class="markdownTableBodyCenter">1.2.11   </td><td class="markdownTableBodyCenter">manual or automatic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Boost   </td><td class="markdownTableBodyCenter">&gt;=1.65   </td><td class="markdownTableBodyCenter">manual   </td></tr>
</table>
<p>You can prepare all dependencies and compile the Validation Suite with these commands: </p><div class="fragment"><div class="line">brew install cmake boost sqlite3</div>
<div class="line">./install_dependencies.sh osx</div>
<div class="line">mkdir build &amp;&amp; cd build &amp;&amp; cmake -G &quot;Unix Makefiles&quot; ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>The VCF Validation Suite binaries will be created in the <code>build/bin</code> subfolder. Optionally, read below for the explanation of the previous commands.</p>
<h4><a class="anchor" id="autotoc_md40"></a>
SQLite, CMake and automatic installation</h4>
<p>The automatic install requires CMake, SQLite3 and wget to be installed before running the script (as ODB and zlib require them to be installed). In order to set up the environment to compile the dependencies, first you need to run <code>brew install cmake boost <a class="el" href="../../d9/dcd/structsqlite3.html">sqlite3</a></code>.</p>
<p>Now you can easily install the ODB ORM and compression libraries just by running <code>./install_dependencies.sh osx</code>. You may run <code>./install_dependencies.sh --help</code> for usage instructions.</p>
<p>A subfolder named <code>osx_dependencies</code> will be created, with all the required libraries copied into it.</p>
<h3><a class="anchor" id="autotoc_md41"></a>
Compile</h3>
<p>In order to create the build scripts, please run <code>cmake</code> with your preferred generator. For instance, <code>mkdir build &amp;&amp; cd build &amp;&amp; cmake -G "Unix Makefiles" ..</code> will create Makefiles, and to build the binaries, you will need to run <code>make</code>.</p>
<p>The VCF Validation Suite binaries will be created in the <code>bin</code> subfolder.</p>
<h2><a class="anchor" id="autotoc_md42"></a>
Windows</h2>
<p>On Windows the binaries obtained will only have ODB libraries dynamically linked. We provide a pre-compiled version of these within the repository because they are not easy to build; but if you would like to do it yourself, please check the <em>Miscellaneous</em> section below.</p>
<h3><a class="anchor" id="autotoc_md43"></a>
Dependencies</h3>
<h4><a class="anchor" id="autotoc_md44"></a>
Compression libraries</h4>
<p>You will need to download the bzip2 and zlib source code, from <a href="http://www.bzip.org/downloads.html">here</a> and <a href="https://zlib.net/zlib1211.zip">here</a> respectively.</p>
<h4><a class="anchor" id="autotoc_md45"></a>
Boost</h4>
<p>The dependencies are the Boost library core, and its submodules: Boost.filesystem, Boost.iostreams, Boost.program_options, Boost.regex, Boost.log and Boost.system. You will need to compile them with zlib and bzip2 support and statically linking the runtime libraries.</p>
<ul>
<li>Download Boost from <a href="https://www.boost.org/users/download/">here</a> and uncompress it</li>
<li>From the directory where Boost was uncompressed, run these commands:</li>
</ul>
<div class="fragment"><div class="line">bootstrap</div>
<div class="line">.\b2 --with-atomic --with-chrono --with-date_time --with-filesystem --with-log --with-program_options --with-regex --with-system --with-thread --with-iostreams -sBZIP2_SOURCE=path\to\bzip2-1.x.x -sZLIB_SOURCE=path\to\zlib-1.x.x runtime-link=static --build-type=complete</div>
</div><!-- fragment --><ul>
<li>Add boost_1_xx_x/stage/lib folder to the environment variable <code>LIB</code></li>
<li>Add boost_1_xx_x folder to the environment variable <code>INCLUDE</code></li>
</ul>
<h4><a class="anchor" id="autotoc_md46"></a>
ODB</h4>
<p>Precompiled libraries of ODB and the ODB SQLite runtime are provided. In order to download headers, simply run the comand <code>install_dependencies.bat</code>, which will create a <code>windows_dependencies</code> folder in the root directory of the project.</p>
<h3><a class="anchor" id="autotoc_md47"></a>
Compile</h3>
<p>In order to create the build scripts and compile vcf-validator, please run the following commands from the project root folder:</p>
<div class="fragment"><div class="line">cmake -DCMAKE_BUILD_TYPE=Release -G &quot;NMake Makefiles&quot; /path/to/CMakeLists.txt</div>
<div class="line">nmake</div>
</div><!-- fragment --><p>Binaries will be created in the <code>bin</code> subfolder.</p>
<p>In order to run those binaries, you will need to add the <code>lib/windows_specific</code> directory to the <code>PATH</code>. This will allow the dll files inside that directory to be found.</p>
<h1><a class="anchor" id="autotoc_md48"></a>
Deliverables</h1>
<p>The following binaries are be created after successful build:</p>
<ul>
<li><code>vcf_validator</code>: VCF validation tool</li>
<li><code>vcf_debugulator</code>: automatic VCF fixing tool</li>
<li><code>vcf_assembly_checker</code>: variant checking tool against FASTA sequence</li>
<li><code>test_validation_suite</code> and derivatives: testing correct behaviour of the tools listed above</li>
</ul>
<h1><a class="anchor" id="autotoc_md49"></a>
Tests</h1>
<p>Unit tests can be run using the binary <code>bin/test_validation_suite</code> or, if the generator supports it, a command like <code>make test</code>. The first option may provide a more detailed output in case of test failure.</p>
<p><b>Note</b>: Tests that require input files will only work when executed with <code>make test</code> or running the binary from the project root folder (not the <code>bin</code> subfolder).</p>
<h1><a class="anchor" id="autotoc_md50"></a>
Generate code from descriptors</h1>
<p>Code generated from descriptors shall be always up-to-date in the GitHub repository. If changes to the source descriptors were necessary, please generate the Ragel machines C code from <code>.ragel</code> files using:</p>
<div class="fragment"><div class="line">ragel -G2 src/vcf/vcf_v41.ragel -o inc/vcf/validator_detail_v41.hpp</div>
<div class="line">ragel -G2 src/vcf/vcf_v42.ragel -o inc/vcf/validator_detail_v42.hpp</div>
<div class="line">ragel -G2 src/vcf/vcf_v43.ragel -o inc/vcf/validator_detail_v43.hpp</div>
</div><!-- fragment --><p>And the full ODB-based code from the classes definitions using:</p>
<div class="fragment"><div class="line">odb --include-prefix vcf --std c++11 -d sqlite --generate-query --generate-schema --hxx-suffix .hpp --ixx-suffix .ipp --cxx-suffix .cpp --output-dir inc/vcf/ inc/vcf/error.hpp</div>
<div class="line">mv inc/vcf/error-odb.cpp src/vcf/error-odb.cpp</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md51"></a>
Miscellaneous</h1>
<h2><a class="anchor" id="autotoc_md52"></a>
Build ODB Libraries for windows</h2>
<p>This section describes how to build the ODB libraries for Windows. You may ignore it if you want to use pre-compiled libraries provided inside the repository. To build those libraries, first download the source code using <code>install_dependencies.bat</code>, which will create the following subfolder inside <code>windows_dependencies</code>:</p>
<ul>
<li>libodb-2.4.0</li>
<li>libodb-sqlite-2.4.0</li>
<li>sqlite</li>
<li>odb (header files only)</li>
</ul>
<p>You will have to compile libodb-2.4.0, sqlite and then libodb-sqlite-2.4.0. The build has been tested on Visual Studio 2017.</p>
<h3><a class="anchor" id="autotoc_md53"></a>
Build ODB runtime</h3>
<ol type="1">
<li>Open libodb-2.4.0/libodb-vc12.sln in VS-Studio. File-&gt;Open-&gt;Project/Solution.</li>
<li>Retarget the solution file to latest version. Project-&gt;Retarget Solution.</li>
<li><a class="el" href="../../d2/d1c/struct_select.html">Select</a> Build type Release and configuration win32.</li>
<li><a class="el" href="../../d2/d1c/struct_select.html">Select</a> /MT in Project-&gt;Properties-&gt;Configuration Properties-&gt;C/C++-&gt;Code Generation-&gt;Runtime Library options.</li>
<li>Build the solution using Build-&gt;Build Solution.</li>
</ol>
<h3><a class="anchor" id="autotoc_md54"></a>
Build SQLite for odb-sqlite</h3>
<ol type="1">
<li>Open sqlite/sqlite3-vc12.sln in VS-Studio.</li>
<li>Retarget the solution file.</li>
<li><a class="el" href="../../d2/d1c/struct_select.html">Select</a> Build type Release and configuration win32.</li>
<li><a class="el" href="../../d2/d1c/struct_select.html">Select</a> /MT in Project-&gt;Properties-&gt;Configuration Properties-&gt;C/C++-&gt;Code Generation-&gt;Runtime Library options.</li>
<li>Build the solution using Build-&gt;Build Solution.</li>
</ol>
<h3><a class="anchor" id="autotoc_md55"></a>
Build ODB-SQLite runtime</h3>
<ol type="1">
<li>Open libodb-sqlite-2.4.0/libodb-sqlite-vc12.sln in VS-Studio.</li>
<li>Retarget the solution file.</li>
<li><a class="el" href="../../d2/d1c/struct_select.html">Select</a> Build type Release and configuration win32.</li>
<li><a class="el" href="../../d2/d1c/struct_select.html">Select</a> /MT in Project-&gt;Properties-&gt;Configuration Properties-&gt;C/C++-&gt;Code Generation-&gt;Runtime Library options.</li>
<li>Go to Project-&gt;Properties-&gt;Configuration Properties-&gt;VC++ Directories and append these paths to following variables.<ul>
<li>Executable Directories =&gt; path/to/libodb-2.4.0/bin and path/to/sqlite/bin</li>
<li>Include Directories =&gt; path/to/libodb-2.4.0 and path/to/sqlite</li>
<li>Library Directories =&gt; path/to/libodb-2.4.0/lib and path/to/sqlite/lib Note the paths should be absolute and the directories will be present within windows_dependencies folder.</li>
</ul>
</li>
<li>Build the solution using Build-&gt;Build Solution.</li>
</ol>
<p>Now you will obtain compiled LIB and DLL files, in the <code>lib</code> and <code>bin</code> folders respectively. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
