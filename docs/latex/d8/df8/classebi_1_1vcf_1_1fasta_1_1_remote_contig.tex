\doxysection{ebi\+::vcf\+::fasta\+::Remote\+Contig Class Reference}
\hypertarget{classebi_1_1vcf_1_1fasta_1_1_remote_contig}{}\label{classebi_1_1vcf_1_1fasta_1_1_remote_contig}\index{ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}}


Inheritance diagram for ebi\+::vcf\+::fasta\+::Remote\+Contig\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=219pt]{de/df9/classebi_1_1vcf_1_1fasta_1_1_remote_contig__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for ebi\+::vcf\+::fasta\+::Remote\+Contig\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=219pt]{dd/d89/classebi_1_1vcf_1_1fasta_1_1_remote_contig__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
std\+::string \mbox{\hyperlink{classebi_1_1vcf_1_1fasta_1_1_remote_contig_ab5a21fce5ceba441bab0a4af0d2e75b8}{sequence}} (const std\+::string \&contig, const size\+\_\+t pos, const size\+\_\+t length)
\item 
bool \mbox{\hyperlink{classebi_1_1vcf_1_1fasta_1_1_remote_contig_abd3bfb9708486816a3e06a349c9d7ae4}{sequence\+\_\+exists}} (const std\+::string \&contig) const
\item 
size\+\_\+t \mbox{\hyperlink{classebi_1_1vcf_1_1fasta_1_1_remote_contig_ac11c532ce898955cb9a5e766300480f7}{sequence\+\_\+length}} (const std\+::string \&contig) const
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \mbox{\hyperlink{fasta_8hpp_source_l00081}{81}} of file \mbox{\hyperlink{fasta_8hpp_source}{fasta.\+hpp}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classebi_1_1vcf_1_1fasta_1_1_remote_contig_a24cc35052dada4452906daa1b0cf109a}\label{classebi_1_1vcf_1_1fasta_1_1_remote_contig_a24cc35052dada4452906daa1b0cf109a} 
\index{ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}!RemoteContig@{RemoteContig}}
\index{RemoteContig@{RemoteContig}!ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}}
\doxysubsubsection{\texorpdfstring{RemoteContig()}{RemoteContig()}}
{\footnotesize\ttfamily ebi\+::vcf\+::fasta\+::\+Remote\+Contig\+::\+Remote\+Contig (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{fasta_8hpp_source_l00084}{84}} of file \mbox{\hyperlink{fasta_8hpp_source}{fasta.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \{\}}

\end{DoxyCode}
\Hypertarget{classebi_1_1vcf_1_1fasta_1_1_remote_contig_a0211dfdb4d19c8f238f4eeb5b611b848}\label{classebi_1_1vcf_1_1fasta_1_1_remote_contig_a0211dfdb4d19c8f238f4eeb5b611b848} 
\index{ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}!````~RemoteContig@{\texorpdfstring{$\sim$}{\string~}RemoteContig}}
\index{````~RemoteContig@{\texorpdfstring{$\sim$}{\string~}RemoteContig}!ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}RemoteContig()}{\string~RemoteContig()}}
{\footnotesize\ttfamily virtual ebi\+::vcf\+::fasta\+::\+Remote\+Contig\+::\texorpdfstring{$\sim$}{\string~}\+Remote\+Contig (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Definition at line \mbox{\hyperlink{fasta_8hpp_source_l00085}{85}} of file \mbox{\hyperlink{fasta_8hpp_source}{fasta.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00085\ \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classebi_1_1vcf_1_1fasta_1_1_remote_contig_ab5a21fce5ceba441bab0a4af0d2e75b8}\label{classebi_1_1vcf_1_1fasta_1_1_remote_contig_ab5a21fce5ceba441bab0a4af0d2e75b8} 
\index{ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}!sequence@{sequence}}
\index{sequence@{sequence}!ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}}
\doxysubsubsection{\texorpdfstring{sequence()}{sequence()}}
{\footnotesize\ttfamily std\+::string ebi\+::vcf\+::fasta\+::\+Remote\+Contig\+::sequence (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{contig,  }\item[{const size\+\_\+t}]{pos,  }\item[{const size\+\_\+t}]{length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Extract n base pairs from the contig starting from an offset 
\begin{DoxyParams}{Parameters}
{\em contig} & -\/ the name of the contig to extract the sequence from \\
\hline
{\em pos} & -\/ the starting offset position \\
\hline
{\em length} & -\/ the number of base pairs to be extracted \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the sequence string, empty if nothing can be extracted. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classebi_1_1vcf_1_1fasta_1_1_i_fasta_aa6377ac082f7b9f3d956cef7a4ea3d99}{ebi\+::vcf\+::fasta\+::\+IFasta}}.



Definition at line \mbox{\hyperlink{fasta_8cpp_source_l00122}{122}} of file \mbox{\hyperlink{fasta_8cpp_source}{fasta.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00123\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{if}\ (contigs.count(contig)\ ==\ 0)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ contigs[contig].reset(\textcolor{keyword}{new}\ \mbox{\hyperlink{classebi_1_1vcf_1_1fasta_1_1_contig_from_e_n_a}{ebi::vcf::fasta::ContigFromENA}}(contig));}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ contig\ is\ not\ downloaded,\ try\ download\ it\ from\ ENA.}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ std::string\ url\ =\ ebi::vcf::ENA\_API\_FASTA\_URL\ +\ contig;}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ std::fstream\ response\_stream;}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ response\_stream.open(contig+\textcolor{stringliteral}{"{}.tmp"{}},\ std::ios::in\ |\ std::ios::out\ |\ std::ios::app);}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ ebi::util::open\_remote(response\_stream,\ url);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ response\_stream.seekg(0,\ std::ios::beg);}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ std::string\ line;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ line.reserve(1024);}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ebi::util::readline(response\_stream,\ line).size()\ !=\ 0)\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (boost::starts\_with(line,\ \textcolor{stringliteral}{"{}>"{}}))\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (ebi::util::readline(response\_stream,\ line).size()\ !=\ 0)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ebi::util::remove\_end\_of\_line(line);\ \textcolor{comment}{//\ ignore\ linebreak\ at\ the\ end\ of\ line}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ contigs[contig]-\/>write(line.c\_str(),\ line.size());}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ response\_stream.close();}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ boost::filesystem::remove(contig+\textcolor{stringliteral}{"{}.tmp"{}});}
\DoxyCodeLine{00147\ \ \ \ \ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{return}\ contigs[contig]-\/>read(pos,\ length);}
\DoxyCodeLine{00150\ \}}

\end{DoxyCode}
\Hypertarget{classebi_1_1vcf_1_1fasta_1_1_remote_contig_abd3bfb9708486816a3e06a349c9d7ae4}\label{classebi_1_1vcf_1_1fasta_1_1_remote_contig_abd3bfb9708486816a3e06a349c9d7ae4} 
\index{ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}!sequence\_exists@{sequence\_exists}}
\index{sequence\_exists@{sequence\_exists}!ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}}
\doxysubsubsection{\texorpdfstring{sequence\_exists()}{sequence\_exists()}}
{\footnotesize\ttfamily bool ebi\+::vcf\+::fasta\+::\+Remote\+Contig\+::sequence\+\_\+exists (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{contig }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}

Check if a contig exists in a FASTA. 
\begin{DoxyParams}{Parameters}
{\em contig} & -\/ the name of the contig \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if the contig exists in the FASTA, false if the contig is not found. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classebi_1_1vcf_1_1fasta_1_1_i_fasta_a9af306075c243560085a718896c74c6d}{ebi\+::vcf\+::fasta\+::\+IFasta}}.



Definition at line \mbox{\hyperlink{fasta_8cpp_source_l00153}{153}} of file \mbox{\hyperlink{fasta_8cpp_source}{fasta.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00154\ \{}
\DoxyCodeLine{00155\ \ \ \textcolor{keywordflow}{return}\ contigs.find(contig)\ !=\ contigs.cend();}
\DoxyCodeLine{00156\ \}}

\end{DoxyCode}
\Hypertarget{classebi_1_1vcf_1_1fasta_1_1_remote_contig_ac11c532ce898955cb9a5e766300480f7}\label{classebi_1_1vcf_1_1fasta_1_1_remote_contig_ac11c532ce898955cb9a5e766300480f7} 
\index{ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}!sequence\_length@{sequence\_length}}
\index{sequence\_length@{sequence\_length}!ebi::vcf::fasta::RemoteContig@{ebi::vcf::fasta::RemoteContig}}
\doxysubsubsection{\texorpdfstring{sequence\_length()}{sequence\_length()}}
{\footnotesize\ttfamily size\+\_\+t ebi\+::vcf\+::fasta\+::\+Remote\+Contig\+::sequence\+\_\+length (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{contig }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}

Get the length of the sequence for a contig 
\begin{DoxyParams}{Parameters}
{\em contig} & -\/ the name of the contig \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the length of the sequence for the contig. 0 if the contig is not found. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classebi_1_1vcf_1_1fasta_1_1_i_fasta_aa4e10949593f7264c8aae236f99e5df3}{ebi\+::vcf\+::fasta\+::\+IFasta}}.



Definition at line \mbox{\hyperlink{fasta_8cpp_source_l00159}{159}} of file \mbox{\hyperlink{fasta_8cpp_source}{fasta.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00160\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keyword}{auto}\ iter\ =\ contigs.find(contig);}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keywordflow}{if}\ (iter\ ==\ contigs.cend())\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{return}\ iter-\/>second-\/>length();}
\DoxyCodeLine{00167\ \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
inc/fasta/fasta.\+hpp\item 
src/fasta/fasta.\+cpp\end{DoxyCompactItemize}
